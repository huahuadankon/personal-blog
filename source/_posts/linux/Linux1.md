---
title: Linux(一)
tags: [操作系统]
categories: [计算机基础]
poster:
  topic: 
  headline: Linux(一)
  caption: 
  color: 
type: tech
date: 2024-10-21 19:06:44
description:
cover: 
banner:
sticky:
mermaid:
katex:
mathjax:
topic:
author:
references:
comments:
indexing:
breadcrumb:
leftbar:
rightbar:
h1:
---

# linux操作系统基础

## 第一章 Linux目录结构

登录系统后，在当前命令窗口下输入命令：

```
 ls / 
```

你会看到如下图所示:

![image-20241021192304828](../assets/Linux/image-20241021192304828.png)

树状目录结构：

![image-20241021192323573](../assets/Linux/image-20241021192323573.png)

以下是对这些目录的解释：

- **/bin**：
  bin 是 Binaries (二进制文件) 的缩写, 这个目录存放着最经常使用的命令。

- **/boot：**
  这里存放的是启动 Linux 时使用的一些核心文件，包括一些连接文件以及镜像文件。

- **/dev ：**
  dev 是 Device(设备) 的缩写, 该目录下存放的是 Linux 的外部设备，在 Linux 中访问设备的方式和访问文件的方式是相同的。

- **/etc：**
  etc 是 Etcetera(等等) 的缩写,这个目录用来存放所有的系统管理所需要的配置文件和子目录。

- **/home**：
  用户的主目录，在 Linux 中，每个用户都有一个自己的目录，一般该目录名是以用户的账号命名的，如上图中的 alice、bob 和 eve。

- **/lib**：
  lib 是 Library(库) 的缩写这个目录里存放着系统最基本的动态连接共享库，其作用类似于 Windows 里的 DLL 文件。几乎所有的应用程序都需要用到这些共享库。

- **/lost+found**：
  这个目录一般情况下是空的，当系统非法关机后，这里就存放了一些文件。

- **/media**：
  linux 系统会自动识别一些设备，例如U盘、光驱等等，当识别后，Linux 会把识别的设备挂载到这个目录下。

- **/mnt**：
  系统提供该目录是为了让用户临时挂载别的文件系统的，我们可以将光驱挂载在 /mnt/ 上，然后进入该目录就可以查看光驱里的内容了。

- **/opt**：
  opt 是 optional(可选) 的缩写，这是给主机额外安装软件所摆放的目录。比如你安装一个ORACLE数据库则就可以放到这个目录下。默认是空的。

- **/proc**：
  proc 是 Processes(进程) 的缩写，/proc 是一种伪文件系统（也即虚拟文件系统），存储的是当前内核运行状态的一系列特殊文件，这个目录是一个虚拟的目录，它是系统内存的映射，我们可以通过直接访问这个目录来获取系统信息。
  这个目录的内容不在硬盘上而是在内存里，我们也可以直接修改里面的某些文件，比如可以通过下面的命令来屏蔽主机的ping命令，使别人无法ping你的机器：

  ```
  echo 1 > /proc/sys/net/ipv4/icmp_echo_ignore_all
  ```

- **/root**：
  该目录为系统管理员，也称作超级权限者的用户主目录。

- **/sbin**：
  s 就是 Super User 的意思，是 Superuser Binaries (超级用户的二进制文件) 的缩写，这里存放的是系统管理员使用的系统管理程序。

- **/selinux**：
   这个目录是 Redhat/CentOS 所特有的目录，Selinux 是一个安全机制，类似于 windows 的防火墙，但是这套机制比较复杂，这个目录就是存放selinux相关的文件的。

- **/srv**：
   该目录存放一些服务启动之后需要提取的数据。

- **/sys**：

  这是 Linux2.6 内核的一个很大的变化。该目录下安装了 2.6 内核中新出现的一个文件系统 sysfs 。

  sysfs 文件系统集成了下面3种文件系统的信息：针对进程信息的 proc 文件系统、针对设备的 devfs 文件系统以及针对伪终端的 devpts 文件系统。

  该文件系统是内核设备树的一个直观反映。

  当一个内核对象被创建的时候，对应的文件和目录也在内核对象子系统中被创建。

- **/tmp**：
  tmp 是 temporary(临时) 的缩写这个目录是用来存放一些临时文件的。

- **/usr**：
   usr 是 unix system resources(unix 系统资源) 的缩写，这是一个非常重要的目录，用户的很多应用程序和文件都放在这个目录下，类似于 windows 下的 program files 目录。

- **/usr/bin：**
  系统用户使用的应用程序。

- **/usr/sbin：**
  超级用户使用的比较高级的管理程序和系统守护程序。

- **/usr/src：**
  内核源代码默认的放置目录。

- **/var**：
  var 是 variable(变量) 的缩写，这个目录中存放着在不断扩充着的东西，我们习惯将那些经常被修改的目录放在这个目录下。包括各种日志文件。

- **/run**：
  是一个临时文件系统，存储系统启动以来的信息。当系统重启时，这个目录下的文件应该被删掉或清除。如果你的系统上有 /var/run 目录，应该让它指向 run。

在 Linux 系统中，有几个目录是比较重要的，平时需要注意不要误删除或者随意更改内部文件。

**/etc**： 上边也提到了，这个是系统中的配置文件，如果你更改了该目录下的某个文件可能会导致系统不能启动。

**/bin, /sbin, /usr/bin, /usr/sbin**: 这是系统预设的执行文件的放置目录，比如 **ls** 就是在 **/bin/ls** 目录下的。

值得提出的是 **/bin**、**/usr/bin** 是给系统用户使用的指令（除 root 外的通用用户），而/sbin, /usr/sbin 则是给 root 使用的指令。

**/var**： 这是一个非常重要的目录，系统上跑了很多程序，那么每个程序都会有相应的日志产生，而这些日志就被记录到这个目录下，具体在 /var/log 目录下，另外 mail 的预设放置也是在这里。

## 第二章 Vi和VM编辑器

所有的 Unix Like 系统都会内建 vi 文书编辑器，其他的文书编辑器则不一定会存在。

但是目前我们使用比较多的是 vim 编辑器。

vim 具有程序编辑的能力，可以主动的以字体颜色辨别语法的正确性，方便程序设计。

相关文章：[史上最全Vim快捷键键位图 — 入门到进阶](https://www.runoob.com/w3cnote/all-vim-cheatsheat.html)

------

### 什么是 vim？

Vim 是从 vi 发展出来的一个文本编辑器。代码补全、编译及错误跳转等方便编程的功能特别丰富，在程序员中被广泛使用。

简单的来说， vi 是老式的字处理器，不过功能已经很齐全了，但是还是有可以进步的地方。 vim 则可以说是程序开发者的一项很好用的工具。

连 vim 的官方网站 (https://www.vim.org/) 自己也说 vim 是一个程序开发工具而不是文字处理软件。

### vim 键盘图

![image-20241021193033940](../assets/Linux/image-20241021193033940.png)

------

### vi/vim 的使用

基本上 vi/vim 共分为三种模式，**命令模式（Command Mode）、输入模式（Insert Mode）和命令行模式（Command-Line Mode）**。

#### 命令模式

**用户刚刚启动 vi/vim，便进入了命令模式。**

此状态下敲击键盘动作会被 Vim 识别为命令，而非输入字符，比如我们此时按下 **i**，并不会输入一个字符，**i** 被当作了一个命令。

以下是普通模式常用的几个命令：

- **i** -- 切换到输入模式，在光标当前位置开始输入文本。
- **x** -- 删除当前光标所在处的字符。
- **:** -- 切换到底线命令模式，以在最底一行输入命令。
- **a** -- 进入插入模式，在光标下一个位置开始输入文本。
- **o**：在当前行的下方插入一个新行，并进入插入模式。
- **O** -- 在当前行的上方插入一个新行，并进入插入模式。
- **dd** -- 剪切当前行。
- **yy** -- 复制当前行。
- **p**（小写） -- 粘贴剪贴板内容到光标下方。
- **P**（大写）-- 粘贴剪贴板内容到光标上方。
- **u** -- 撤销上一次操作。
- **Ctrl + r** -- 重做上一次撤销的操作。
- **:w** -- 保存文件。
- **:q** -- 退出 Vim 编辑器。
- **:q!** -- 强制退出Vim 编辑器，不保存修改。

若想要编辑文本，只需要启动 Vim，进入了命令模式，按下 **i** 切换到输入模式即可。

命令模式只有一些最基本的命令，因此仍要依靠**底线命令行模式**输入更多命令。

#### 输入模式

在命令模式下按下 **i** 就进入了输入模式，使用 **Esc** 键可以返回到普通模式。

在输入模式中，可以使用以下按键：

- **字符按键以及Shift组合**，输入字符
- **ENTER**，回车键，换行
- **BACK SPACE**，退格键，删除光标前一个字符
- **DEL**，删除键，删除光标后一个字符
- **方向键**，在文本中移动光标
- **HOME**/**END**，移动光标到行首/行尾
- **Page Up**/**Page Down**，上/下翻页
- **Insert**，切换光标为输入/替换模式，光标将变成竖线/下划线
- **ESC**，退出输入模式，切换到命令模式

#### 底线命令模式

在命令模式下按下 **:**（英文冒号）就进入了底线命令模式。

底线命令模式可以输入单个或多个字符的命令，可用的命令非常多。

在底线命令模式中，基本的命令有（已经省略了冒号）：

- `:w`：保存文件。
- `:q`：退出 Vim 编辑器。
- `:wq`：保存文件并退出 Vim 编辑器。
- `:q!`：强制退出Vim编辑器，不保存修改。

按 **ESC** 键可随时退出底线命令模式。

简单的说，我们可以将这三个模式想成底下的图标来表示：

![image-20241021193105541](../assets/Linux/image-20241021193105541.png)

## 第三章 用户和用户组管理

在Linux中，**用户**（User）和**用户组**（Group）是操作系统中用于管理权限和访问控制的两个重要概念。

### 用户（User）

- **用户**是一个能够登录到系统的个体，通常每个用户都有一个唯一的账号。
- 每个用户都有自己的文件、配置和权限。
- 在Linux中，用户的信息存储在`/etc/passwd`文件中，每个用户都关联一个唯一的用户ID（UID）。

### 用户组（Group）

- **用户组**是一组用户的集合，用于集中管理权限。如果多个用户需要访问同一资源（如文件或目录），可以通过将这些用户添加到同一个用户组来实现。
- 每个用户组都有一个唯一的组ID（GID）。
- 用户组的信息存储在`/etc/group`文件中。

每个用户都至少属于一个组，这个组被称为**主组**（Primary Group）。用户也可以属于多个其他的组，这些称为**附加组**（Supplementary Groups）。

### 用户和用户组的常用管理指令

sudo 表示最高权限

1. **添加用户**

   ```
   useradd [选项]  <用户名>
   ```

   - `useradd`用于创建新用户，并生成默认的主目录、用户组等，默认在家目录/home/用户名

   - 例如：`sudo useradd alice`

     参数说明：

     - 选项:

       - -c comment 指定一段注释性描述。
       - -d 目录 指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录。
       - -g 用户组 指定用户所属的用户组。
       - -G 用户组，用户组 指定用户所属的附加组。
       - -s Shell文件 指定用户的登录Shell。
       - -u 用户号 指定用户的用户号，如果同时有-o选项，则可以重复使用其他用户的标识号。

     - 用户名:

       指定新账号的登录名。

2. **删除用户**

   ```
   sudo userdel [选项] <用户名>
   ```

   - `userdel`用于删除用户。
   - 如果要删除用户的主目录以及所有相关文件，可以使用`-r`选项：`sudo userdel -r alice`

3. **修改用户信息**

   ```
   sudo usermod [选项] <用户名>
   ```

   - `usermod`用于修改现有用户的属性。

   - 例如，修改用户的主目录：`sudo usermod -d /new_home_directory alice`

   - 常用的选项包括`-c, -d, -m, -g, -G, -s, -u以及-o等`，这些选项的意义与`useradd`命令中的选项一样，可以为用户指定新的资源值。

     另外，有些系统可以使用选项：-l 新用户名

4. **添加用户到组**

   ```
   sudo usermod -aG <组名> <用户名>
   ```

   - 例如：`sudo usermod -aG sudo alice` 将用户`alice`添加到`sudo`组，使其具有超级用户权限。

5. 查询指定用户信息

   ```
   id 用户名
   ```

6. **创建用户组**

   ```
   groupadd [选项] <组名>
   ```

   - 例如：`sudo groupadd developers`
   - 可以使用的选项有：
     - -g GID 指定新用户组的组标识号（GID）。
     - -o 一般与-g选项同时使用，表示新用户组的GID可以与系统已有用户组的GID相同。

7. **删除用户组**

   ```
   groupdel <组名>
   ```

   - 例如：`sudo groupdel developers`

8. **查看用户所属组**

   ```
   groups <用户名>
   ```

   - 例如：`groups alice` 可以查看用户`alice`所属的所有组。

9. **修改用户组的属性**

   ```
   groupmod 选项 用户组
   ```

   常用的选项有：

   - -g GID 为用户组指定新的组标识号。
   - -o 与-g选项同时使用，用户组的新GID可以与系统已有用户组的GID相同。
   - -n新用户组 将用户组的名字改为新名字

   实例1：

   ```
   groupmod -g 102 group2
   ```

   此命令将组group2的组标识号修改为102。

   实例2：

   ```
   groupmod –g 10000 -n group3 group2
   ```

   此命令将组group2的标识号改为10000，组名修改为group3。

10. **修改用户密码**

    ```
    sudo passwd <用户名>
    ```

    - 例如：`sudo passwd alice` 会为`alice`用户设置密码。

11. **切换用户**

    ```
    su - <用户名>
    ```

    - 例如：`su - alice` 切换到用户`alice`的身份，常用于临时切换到其他用户操作。

12. **查看当前用户**

    ```
    whoami
    ```

13. **列出所有用户**

    ```
    cat /etc/passwd
    ```

14. **列出所有组**

    ```
    cat /etc/group
    ```

### 一些常见的UID与GID范围

- UID/GID 0: 超级用户（`root`）
- UID 1-99: 系统保留用户
- UID/GID 1000以上: 普通用户

## 第四章 Linux常用指令

### 文件与目录操作

1. **ls**：列出目录内容
   - **示例**：`ls -alh` 显示所有文件和详细信息。

2. **cd**：切换目录
   - **示例**：`cd /home/user` 切换到指定目录。

3. **cp**：复制文件或目录
   - **示例**：`cp -r source_dir dest_dir` 递归复制目录。

4. **mv**：移动或重命名文件/目录
   - **示例**：`mv oldname.txt newname.txt` 将文件重命名。

5. **rm**：删除文件或目录
   - **示例**：`rm -rf dir` 强制删除目录及其内容。

6. **mkdir**：创建目录
   - **示例**：`mkdir -p /path/to/newdir` 创建多级目录。

7. **rmdir**：删除空目录
   - **示例**：`rmdir emptydir` 删除空目录。

8. **touch**：创建空文件或更新文件的时间戳
   - **示例**：`touch newfile.txt` 创建新文件。

9. **find**：查找文件或目录
   - **示例**：`find /home -name "*.txt"` 查找指定类型的文件。

10. **du**：查看目录或文件的磁盘使用情况
    - **示例**：`du -sh /home` 显示指定目录的总大小。

11. **df**：查看磁盘分区使用情况
    - **示例**：`df -h` 显示所有分区的使用情况。

12. **ln**：创建链接
    - **示例**：`ln -s /path/to/file /path/to/link` 创建符号链接。

### 文件压缩与解压缩

13. **tar**：打包和解压缩文件
    - **示例**：`tar -czvf archive.tar.gz dir/` 压缩目录。

14. **zip/unzip**：压缩和解压缩.zip文件
    - **示例**：`zip -r archive.zip dir/` 创建.zip压缩包。

### 文件查看与文本处理

15. **cat**：显示文件内容
    - **示例**：`cat file.txt` 查看文件内容。

16. **less**：逐页查看文件内容
    - **示例**：`less file.txt` 分页查看文件。

17. **head**：查看文件的前几行
    - **示例**：`head -n 10 file.txt` 查看前10行。

18. **tail**：查看文件的末尾几行
    - **示例**：`tail -n 10 file.txt` 查看最后10行。

19. **grep**：文本搜索
    - **示例**：`grep "text" file.txt` 查找包含指定文本的行。

20. **pipe |**：管道符，将一个命令的输出作为另一个命令的输入
    - **示例**：`cat file.txt | grep "hello"` 从文件中过滤文本。

### 系统管理与监控

21. **ps**：查看进程状态
    - **示例**：`ps aux` 显示所有进程的信息。

22. **top**：实时显示系统进程
    - **示例**：`top` 显示当前运行的进程和系统资源使用情况。

23. **kill**：终止进程
    - **示例**：`kill -9 PID` 强制终止指定PID的进程。

24. **free**：查看内存使用情况
    - **示例**：`free -h` 显示内存使用情况。

### 权限与用户管理

25. **chmod**：修改文件或目录权限
    - **示例**：`chmod 755 file.sh` 设置文件权限。

26. **chown**：修改文件或目录所有者
    - **示例**：`sudo chown user:group file.txt` 修改文件的所有者和组。

27. **passwd**：修改用户密码
    - **示例**：`passwd username` 修改指定用户的密码。

28. **useradd**：添加新用户
    - **示例**：`sudo useradd newuser` 添加新用户。

29. **usermod**：修改用户信息
    - **示例**：`sudo usermod -aG groupname username` 将用户添加到组中。

30. **userdel**：删除用户
    - **示例**：`sudo userdel username` 删除指定用户。

### 日期与时间操作

31. **date**：显示或设置系统日期与时间
    - **示例**：`date "+%Y-%m-%d %H:%M:%S"` 显示当前日期和时间。

32. **cal**：显示日历
    - **示例**：`cal 2024` 显示指定年份的日历。

### 网络相关指令（可选）

33. **ping**：测试网络连通性
    - **示例**：`ping google.com` 测试到 Google 的连接。

34. **ifconfig/ip**：查看或配置网络接口
    - **示例**：`ifconfig` 或 `ip addr` 查看网络接口信息。

35. **netstat**：查看网络连接状态
    - **示例**：`netstat -tuln` 查看监听的端口。

### 其他实用指令

36. **man**：查看命令手册
    - **示例**：`man ls` 显示 `ls` 命令的使用说明。

37. **history**：查看命令历史
    - **示例**：`history` 显示执行过的命令记录。

38. **clear**：清屏
    - **示例**：`clear` 清除终端屏幕的内容。

39. **echo**：显示文本
    - **示例**：`echo "Hello, World"` 输出文本。

40. **exit**：退出终端或注销当前用户
    - **示例**：`exit` 退出当前会话。

这些指令覆盖了文件和目录操作、系统管理、用户和权限管理等多方面的功能，可以帮助用户更有效地使用Linux系统。

## 第五章 Linux权限机制

在Linux中，权限机制是控制用户对文件和目录操作的一种重要机制。每个文件和目录都有三个主要的权限类型，分别是读取（Read）、写入（Write）和执行（Execute），这些权限可以由不同的用户群体（用户、组和其他用户）进行管理。

#### 1. 权限类型

- **读取权限（r）**：
  - **文件**：允许查看文件内容。
  - **目录**：允许列出目录中的文件。

- **写入权限（w）**：
  - **文件**：允许修改文件内容。
  - **目录**：允许在目录中添加、删除或重命名文件。

- **执行权限（x）**：
  - **文件**：允许执行该文件（通常是脚本或程序）。
  - **目录**：允许进入该目录。

#### 2. 权限表示

权限通过一串10个字符来表示，每个字符代表不同的含义：

- **第0位**：文件类型
  - `-`：普通文件
  - `d`：目录
  - `l`：符号链接
  - `c`：字符设备文件
  - `b`：块设备文件

- **第1-3位**：属主（User）权限
  - `r`：可读
  - `w`：可写
  - `x`：可执行

- **第4-6位**：所属组（Group）权限
  - `r`：可读
  - `w`：可写
  - `x`：可执行

- **第7-9位**：其他用户（Others）权限
  - `r`：可读
  - `w`：可写
  - `x`：可执行

**示例**：
```
-rwxr-xr--
```
- **`-`**：普通文件
- **`rwx`**：属主拥有读、写和执行权限
- **`r-x`**：所属组拥有读和执行权限
- **`r--`**：其他用户只有读权限

#### 3. 权限管理命令

- **查看权限**：
  - 使用 `ls -l` 命令可以查看文件和目录的权限设置。
  - 示例：`ls -l file.txt`

- **修改权限**：
  - 使用 `chmod` 命令来修改权限。
  - **符号模式**：
    - `u`：用户（属主）
    - `g`：组
    - `o`：其他
    - 示例：`chmod u+x file.sh` 为属主添加执行权限。
  - **数字模式**：
    - 权限用数字表示：读=4，写=2，执行=1。
    - 示例：`chmod 755 file.sh` 设置属主为读、写、执行权限，组和其他用户为读和执行权限。

- **修改文件属主和组**：
  - 使用 `chown` 命令。
  - 示例：`sudo chown user:group file.txt` 修改文件属主和组。

#### 4. 特殊权限

- **Setuid（s）**：
  - 在可执行文件上设置，允许用户以文件属主的身份执行该文件。
  - **示例**：`chmod u+s file` 设置 Setuid 权限。

- **Setgid（s）**：
  - 在目录上设置，允许新创建的文件和子目录继承所属组。
  - **示例**：`chmod g+s dir` 设置 Setgid 权限。

- **Sticky Bit（t）**：
  - 在公共目录上设置，只有文件的属主可以删除或重命名文件。
  - **示例**：`chmod +t dir` 设置 Sticky Bit 权限。

#### 5. 继承权限

- 在创建文件时，默认权限会受到当前用户和组的影响。可以使用 umask 命令来设置默认权限掩码。

**示例**：
```
umask 0022
```
- 在此示例中，默认创建的文件权限将是 `rw-r--r--`。

在Linux中，文件和目录的权限由 **rwx**（读、写、执行）三个符号控制，这些符号的含义和作用因文件与目录的不同而有所区别。接下来我们分别介绍文件和目录中 `rwx` 权限的具体机制，并通过举例说明它们的功能。

---

### 文件权限机制

文件的权限可以控制用户对该文件的操作，包括读取文件内容、修改文件、执行文件等。

#### 1. **r（Read）- 读权限**

- **含义**：允许读取文件的内容。
- **机制**：如果用户对文件具有读权限，则可以查看文件的内容，通常通过 `cat`、`less`、`more` 等命令读取文件内容。
  
- **示例**：
   ```bash
   $ cat /path/to/file.txt
   ```
   如果当前用户对 `file.txt` 有读权限，则可以查看文件内容；否则将出现权限拒绝错误。

#### 2. **w（Write）- 写权限**

- **含义**：允许修改文件的内容。
- **机制**：如果用户对文件有写权限，可以编辑或修改文件的内容（例如用 `nano`、`vi` 等文本编辑器）。需要注意的是，拥有写权限不意味着用户可以删除文件，文件的删除权限与目录的写权限有关（后续解释）。

- **示例**：
   ```bash
   $ echo "Hello" >> /path/to/file.txt
   ```
   如果用户对 `file.txt` 有写权限，那么可以向文件追加内容。如果没有写权限，会提示权限不足。

#### 3. **x（Execute）- 执行权限**

- **含义**：允许执行该文件（通常是脚本或二进制可执行文件）。
- **机制**：执行权限主要用于可执行文件（如shell脚本、二进制程序）。当用户对文件有执行权限时，可以直接运行这个文件。

- **示例**：
   ```bash
   $ ./script.sh
   ```
   如果 `script.sh` 文件有执行权限，用户可以直接运行脚本。如果没有执行权限，即使有读权限，用户也只能读取脚本内容，无法执行。

---

### 目录权限机制

目录的 `rwx` 权限与文件有所不同，它决定了用户对该目录及其内容的访问、查看和修改操作。

#### 1. **r（Read）- 读权限**

- **含义**：允许列出目录中的文件名（但不一定能读取文件内容）。
- **机制**：如果用户对目录有读权限，则可以列出该目录下的文件和子目录的名称，通常通过 `ls` 命令实现。

- **示例**：
   ```bash
   $ ls /path/to/directory/
   ```
   如果用户对该目录有读权限，可以看到目录中的文件和目录名；否则将显示“Permission denied”（权限不足）。

#### 2. **w（Write）- 写权限**

- **含义**：允许在目录中创建、删除和重命名文件或子目录。
- **机制**：写权限与目录中的内容管理有关。如果用户对目录有写权限，可以在目录中创建新文件、删除文件、修改文件名或子目录。

- **示例**：
   ```bash
   $ touch /path/to/directory/newfile.txt  # 创建新文件
   $ rm /path/to/directory/existingfile.txt  # 删除文件
   ```
   需要注意的是，删除一个文件并不取决于该文件的权限，而是取决于用户对文件所在目录的写权限。如果用户对目录有写权限，即使没有文件本身的写权限，也可以删除该文件。

#### 3. **x（Execute）- 执行权限**

- **含义**：允许用户进入该目录和访问其中的内容。
- **机制**：执行权限对于目录来说，允许用户“进入”该目录，即使用户对目录有读权限，只有同时具有执行权限才能使用 `cd` 进入该目录并访问文件。

- **示例**：
   ```bash
   $ cd /path/to/directory
   ```
   如果用户对该目录有执行权限，可以进入目录并执行访问操作。如果没有执行权限，用户将无法进入目录，甚至无法访问目录中的任何文件，即使知道文件名。

---

### 文件和目录权限的区别总结

| 权限符 | **文件** 的作用                          | **目录** 的作用                              |
| ------ | ---------------------------------------- | -------------------------------------------- |
| **r**  | 允许读取文件内容。                       | 允许列出目录中的文件和子目录名。             |
| **w**  | 允许修改文件内容。                       | 允许创建、删除和重命名目录中的文件和子目录。 |
| **x**  | 允许执行文件（脚本或二进制可执行文件）。 | 允许进入目录并访问其中的内容。               |

---

### 结合文件与目录权限的实战案例

#### **案例 1**：控制文件读取与执行

假设有一个目录 `/home/alice/`，其中有一个脚本文件 `run.sh`，你想让所有用户都能运行这个脚本，但不允许其他用户读取脚本内容。你可以使用以下权限设置：

```bash
$ chmod 711 /home/alice/run.sh
```

- **权限解读**：
  - `7`：文件所有者 `alice` 可以读、写、执行这个文件。
  - `1`：组内用户和其他用户只能执行文件，无法读取或修改文件内容。

通过这种设置，其他用户可以运行 `run.sh` 脚本，但无法查看其中的内容。

#### **案例 2**：共享目录权限

假设你在 `/shared/` 目录下设置了一个共享工作目录 `dev/`，团队成员可以自由创建、编辑和删除文件，但不允许非团队成员进入该目录。可以使用以下权限设置：

```bash
$ chmod 770 /shared/dev
```

- **权限解读**：
  - `7`：目录所有者和组成员可以读取、写入和进入该目录（即完全权限）。
  - `0`：其他用户没有任何权限，既不能进入目录，也不能查看其中的内容。

通过这种权限设置，非团队成员无法进入 `dev` 目录。

---

### 特殊情况：没有 `x` 权限的目录

如果一个用户对某个目录有 `r` 权限但没有 `x` 权限，用户将可以列出目录中的文件名，但无法进入目录，也无法访问文件内容。举例：

```bash
$ ls /restricted_dir
ls: cannot access '/restricted_dir': Permission denied
```

即使用户有读权限，由于缺乏执行权限，用户无法查看目录内容或进入目录。

---

## 第六章 定时任务调度

#### 1. cron

`cron` 是一种定期执行任务的调度程序，可以在特定的时间、日期或间隔运行指定的命令或脚本。用户可以通过编辑特定的文件来设置定时任务。

示例图

![image-20241021214047294](E:\PersonalWebsite\source\assets\Linux\image-20241021214047294.png)

##### 使用方法

- **crontab 命令**：用于管理 `cron` 任务。

- **编辑用户的 crontab**：
  ```bash
  crontab -e
  ```

- **查看当前用户的 crontab**：
  ```bash
  crontab -l
  ```

- **删除当前用户的 crontab**：
  ```bash
  crontab -r
  ```

##### crontab 文件格式

每一行定义一个定时任务，格式如下：
```
* * * * * command_to_execute
```
- 第1位：分钟（0-59）
- 第2位：小时（0-23）
- 第3位：日（1-31）
- 第4位：月（1-12）
- 第5位：星期几（0-6，0表示星期天）

##### 示例

1. 每天凌晨 2 点执行备份脚本：
   ```bash
   0 2 * * * /path/to/backup.sh
   ```

2. 每小时执行一次：
   ```bash
   0 * * * * /path/to/script.sh
   ```

3. 每周一上午 6 点执行更新命令：
   ```bash
   0 6 * * 1 /usr/bin/apt update
   ```

#### 2. at

`at` 是一种用于安排一次性任务的调度程序，适合于需要在特定时间点执行的命令，而不是周期性任务。

##### 使用方法

- **使用 at 命令**：调度一次性任务。

- **调度任务**：
  ```bash
  echo "command_to_execute" | at time
  ```

- **示例**：在明天的上午 9 点执行命令：
  ```bash
  echo "/path/to/script.sh" | at 09:00 tomorrow
  ```

- **查看待执行的 at 任务**：
  ```bash
  atq
  ```

- **取消任务**：
  ```bash
  atrm job_number
  ```

##### 示例

1. 在今天晚上 11 点执行备份脚本：
   ```bash
   echo "/path/to/backup.sh" | at 23:00
   ```

2. 在 10 分钟后执行清理操作：
   ```bash
   echo "/path/to/cleanup.sh" | at now + 10 minutes
   ```

### cron 与 at 的比较

| 特性       | cron                       | at                   |
| ---------- | -------------------------- | -------------------- |
| 用途       | 定期执行任务               | 一次性执行任务       |
| 适用场景   | 每天、每周、每月等定期任务 | 特定时间点的单次任务 |
| 管理方式   | 通过 crontab 文件配置      | 通过 at 命令直接调度 |
| 任务持久性 | 任务持久存在于 crontab 中  | 任务在执行后自动删除 |
| 灵活性     | 可以设置复杂的时间表达式   | 时间格式相对简单     |



